% &latex
\documentclass{article}

 
\usepackage{amsthm}
\newtheorem{definition}{Definition}
\newtheorem{example}{Example}


\usepackage{outlines}
\usepackage{enumitem}
\setenumerate[1]{label=\arabic*.}
\setenumerate[2]{label=\alph*.}
\setenumerate[3]{label=\roman*.}
\setenumerate[4]{label=\alph*.}

\usepackage{graphicx}
\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}


\input{coding.tex}




\begin{document}

%+Title
\title{Database Design II: Normalization Forms
%\begin{large} 
%  Normalization Forms
%\end{large}
}
\author{DSC 301: Lecture 9}
\date{February 24, 2021} % \today
\maketitle
%-Title

%+Abstract
%\begin{abstract}
%    There is abstract text that you should replace with your own. 
%\end{abstract}
%-Abstract



%+Contents
% \tableofcontents
%-Contents

% ---------------- %
\begin{outline}[enumerate]

\end{outline}
% ---------------- %
\begin{outline}
        
\end{outline}




% --------- Lecture Objectives ------- %
\section*{Lecture Objectives}
\begin{outline}
        \1  Review Functional Dependencies
        \1  State purpose of normalization
                \2 Mention performance trade-off, thus denormalization 
        \1  State Normalization Forms
        \1  Apply normalization (use MySQL Workbench)
\end{outline}

% --------------------------------------------------
\hspace{-0.5cm}\rule[-0.101in]{\textwidth}{0.0025in}
% --------------------------------------------------












% -------- Review Functional Dependencies  -------- %
\subsection*{Functional Dependencies (FD)}  
 
\begin{outline}[]
    \1 Notation: $A \to B$ read ``$B$ is functionally dependent on $A$" (or $A$ determines $B$)
    \1 Generalizes concept of keys (i.e., a key is a FD)
    \1 $A \to B$ if $t_i[B] = t_j[B]$ when $t_i[A] = t_j[A]$ for all $i,j$.
    \1 Used in the normalization process (topic of this lecture)
\end{outline}





% ---- Example ----- % 
\begin{example}
        Given the relation $R$ in Table \ref{tab:xfd}, verify that $A \to B$.  Find another FD.  
\end{example}

% ------ Relation used in Example ------ %              
\AtBeginEnvironment{tabular}{\sffamily}
\begin{table}[h!]
\caption{Functional Dependency}
\begin{center}

R = \begin{tabular}{|c|c|c|c|}
   \hline
  \cellcolor{excel}{A}  & \cellcolor{excel}{B}  &   \cellcolor{excel}{C}
&  \cellcolor{excel}{D}  \\
  \hline
  1 & 1 & 1  &   1 \\
      \hline
  1 & 1 & 3  &   1 \\
      \hline
  2 & 1 & 3  &   4 \\
      \hline
  2 & 1 & 3  &   1 \\
      \hline 
  3 & 6 & 3  &   1 \\
      \hline 
\end{tabular}
\end{center}
\label{tab:xfd}
\end{table}%
% ------------------------- % 
% 



\newpage

% --------------------------------------------------
\hspace{-0.5cm}\rule[-0.101in]{\textwidth}{0.0025in}
% --------------------------------------------------
  












% -------- Purpose of Normalization  -------- %
\section*{Purpose of Normalization}

A table (i.e., relation) is the basic building block of a database, therefore its design is of significant importance.  How to produce good table structures?  %  Good design means good relational structure.  

% DEFINTION: Normalization
\begin{definition}
    \textbf{Normalization} is a technique to produce a \underline{set} of relations with certain desirable properties (given data requirements of the enterprise\footnote{Needs of the organization}).      
\end{definition}
 
 
\begin{outline}[]
    
    \1 Minimize redundancy 
        \2 reduce opportunities for inconsistencies (typically from updates)
        \2 reduce storage
        \2 considered as an anomaly 
        \2 NOTE: minimize does not mean eliminate (e.g., keys are redundant)

    % \1 Optimize attribute groupings
    
    \1 Eliminate anomalies 
    
    \1 Facilitate multiple table queries
       
\end{outline}
 

 
 
% --------------------------------------------------
\hspace{-0.5cm}\rule[-0.101in]{\textwidth}{0.0025in}
% --------------------------------------------------
  

 


















% -------- Normalization Forms  -------- %
\section*{Normalization Forms}
Except for the first normal form (\texttt{1NF}), all normal forms based on functional dependencies.  Because higher normal forms deal with situations extremely rare\footnote{Analytic (statistical) research applications beyond the scope of business operations.}, we only discuss the first three normal forms. In addition, there are trade-offs between data redundancy and
performance.  Normalizing reduces redundancy at the expense of performance.
 Therefore, occasionally, we \textbf{denormalize} database tables to reduce
the number of \textit{joins}.\\

\noindent  A database is \textit{normalized} if it is in third-normal form.  A relation not normalized is said to be in \textit{unnormalized form} (\texttt{UNF}).  Normal forms are executed as a series of steps.  

%  Boyce-Codd Normal Form?  Cover it?
%  
\begin{outline}[enumerate]
    
    \1 \texttt{1NF}: Each row is unique\footnote{i.e., Key exists}, no repeated columns, and all cells are atomic.  
    
    \1 \texttt{2NF}: In \texttt{1NF} and contains no partial dependencies.
    
    \1 \texttt{3NF}: In \texttt{2NF} and contains no transitive dependencies.
    
\end{outline}


% \noindent \textbf{Note}: There are trade-offs between data redundancy and performance.  Normalizing reduces redundancy at the expense of performance.  Therefore, occasionally, we \textbf{denormalize} database tables to reduce the number of \textit{joins}.
 
% --------------------------------------------------
\hspace{-0.5cm}\rule[-0.101in]{\textwidth}{0.0025in}
% --------------------------------------------------
  
  













%   
% ------ FIRST NORMAL FORM: 1NF ------ %   
\subsection*{First Normal Form} 

Each row is unique, no repeated columns, and all cells are atomic.

  \begin{example}
  Identify why the given table is unnormalized. 
\end{example}


 
 % ------ Non-normalize Table ------ %              
\AtBeginEnvironment{tabular}{\sffamily}
\begin{table}[h!]
\caption{Non-normalize Table}
\begin{center}

\text{Students} = \begin{tabular}{|c|c|c|c|}
   \hline
   \cellcolor{excel}{Name}  &   \cellcolor{excel}{Class 1}
&  \cellcolor{excel}{Class 2} &  \cellcolor{excel}{Class 3} \\
  \hline
   Norville Rogers & MAT480  &   MAT405 & ART101 \\
      \hline
   Fred Jones & MAT190  &   ENV104 & BIO110 \\
 
      \hline 
  Daphne Blake & MAT190  &   ENV104 &    \\
        \hline 
\end{tabular}
\end{center}
\label{tab:unf1}
\end{table}%
% ------------------------- % 
% 
% 
% 







% ------ Example ------%
\begin{example}
  Identify why the given table is unnormalized. 
\end{example}


 % ------ UNF: not atomic cells ------ %              
\AtBeginEnvironment{tabular}{\sffamily}
\begin{table}[h!]
\caption{Non-normalize Table.  Note: this may be a good spreadsheet design and great view for a report.  }
\begin{center}

\text{Students} = \begin{tabular}{|c|c|c|c|c|}
   \hline
  \cellcolor{excel}{ID}  & \cellcolor{excel}{Name}  &   \cellcolor{excel}{Class}
&  \cellcolor{excel}{Rank} &  \cellcolor{excel}{Hours} \\
  \hline
  1 & Norville Rogers & MAT190  &   Freshman & 18 \\
      
    &  & ENV104  &  &   \\
      
    &   & BIO110  &  &   \\
      \hline
  2 & Fred Jones & MAT480  &   Senior & 101 \\ % Barnaby
 
    &   & MAT405  &  &   \\
      
    &  & ART101  &   &  \\
   \hline
   3 & Daphne Blake & MAT190  &   Freshman & 25 \\

     &   &ENV104  &  &   \\
 
      \hline 
\end{tabular}
\end{center}
\label{tab:unf2}
\end{table}%
% ------------------------- % 
% 
% 
% 

\newpage




 % ------ Table in 1NF ------ %              
\AtBeginEnvironment{tabular}{\sffamily}
\begin{table}[h!]
\caption{Table in \texttt{1NF}.  \textbf{Note}: There still exists many update anomalies and data redundancy.}
\begin{center}

\begin{tabular}{|c|c|c|c|c|c|c|}
   \hline
  \cellcolor{excel}{StudentID}  & \cellcolor{excel}{First} & \cellcolor{excel}{Last} &   \cellcolor{excel}{Class} &  \cellcolor{excel}{Description}
&  \cellcolor{excel}{Rank} &  \cellcolor{excel}{Hours} \\
  \hline
  1 & Norville & Rogers & MAT190 & Calculus 1 &   Freshman & 18 \\
      \hline
  1 & Norville & Rogers & ENV104 & EnvSci. &   Freshman & 18 \\
      \hline
  1 & Norville & Rogers & BIO110 & Biology &   Freshman & 18 \\
      \hline
  2 & Fred & Jones & MAT480  & Math Research &  Senior & 101 \\ % Barnaby
  \hline
  2 & Fred &  Jones & MAT405 &Numerical Analysis &   Senior & 101\\
      \hline 
  2 & Fred &  Jones & ART101 & Drawing  &   Senior & 101 \\
   \hline
   3 & Daphne & Blake & MAT190 & Calculus 1 &   Freshman & 25 \\
   \hline
   3 & Daphne & Blake &ENV104 & EnvSci. &   Freshman & 25\\
 
      \hline 
\end{tabular}
\end{center}
\label{tab:1nf}
\end{table}%
% ------------------------- % 
% 
% 
% 

% --------------------------------------------------
\hspace{-0.5cm}\rule[-0.101in]{\textwidth}{0.0025in}
% --------------------------------------------------
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 % ------- 2NF ---------- %
 \subsection*{Second Normal Form}
 
 Table must be in \texttt{1NF} and no partial dependencies (i.e., every non-key column must depend on the entire key).  In Table \ref{tab:1nf}, (\underline{\texttt{StudentID}} , \underline{\texttt{Class}}) is a primary key.  However, \texttt{StudentID} $\to $ \texttt{First} is a partial dependency.  That is, \texttt{First} is depends on \texttt{StudentID}.  In fact, so does \texttt{Last} and \texttt{Rank}.  Said another way, \texttt{Rank}, for example, does NOT depend on the entire key (only part of the key).  In addition, \texttt{Description} only depends on \texttt{Class} instead of the entire key.  We decompose table into two tables for which there are no partial dependencies.  


  
 
 

 % ------ Table with San Serif Font ------ %              
\AtBeginEnvironment{tabular}{\sffamily}
\begin{table}[h!]
\caption{Table in \texttt{2NF}.  \textbf{Note}: reduced redundancy and all non-key columns (i.e., \texttt{First, Last, Rank, Hours} depend entirely on \texttt{StudentID}.    }
\begin{center}

Students = \begin{tabular}{|c|c|c|c|c|}
   \hline
  \cellcolor{excel}{StudentID}  & \cellcolor{excel}{First} & \cellcolor{excel}{Last}
&  \cellcolor{excel}{Rank} &  \cellcolor{excel}{Hours}  \\
  \hline
  
  1 & Norville & Rogers &   Freshman & 18 \\
      \hline

  2 & Fred & Jones  &  Senior & 101 \\ 
  \hline
 
   3 & Daphne & Blake &  Freshman & 25 \\
      \hline 
      
\end{tabular}
\end{center}
\label{tab:2nf1}
\end{table}%
% ------------------------- % 
% 
% 
% 
 
\noindent \textbf{Note}: It is important to point out that functional dependencies are not particular to an instance (i.e., the Students relation above), but a general property (constraint)\ on the schema.  For example, in the Students relation above, technically \texttt{First} $\to$ \texttt{Last}, but actually we should not expect this dependency to hold.  There are many students that have same first names and different last names or same first and last names.   

 

 % ------ Table with San Serif Font ------ %              
\AtBeginEnvironment{tabular}{\sffamily}
\begin{table}[h!]
\caption{Table not in \texttt{2NF}.  What is the key? \texttt{Class, StudentID}.   Note that \texttt{Description} is dependent on only part of the key (i.e., \texttt{Class}).   
   }
\begin{center}

Classes = \begin{tabular}{|c|c|c|}
   \hline
  \cellcolor{excel}{Class}  & \cellcolor{excel}{Description} & \cellcolor{excel}{StudentID}
  \\
  \hline
  MAT190 & Calculus 1 & 1  \\
      \hline
 MAT190 & Calculus 1 & 3  \\
      \hline
 
 ENV104 & EnvSci. & 1  \\
      \hline
      
      
 ENV104 & EnvSci. & 3  \\
      \hline
 


BIO110 & Biology & 1  \\
      \hline
      
 MAT480 & Math Research & 2  \\
      \hline
      
 MAT405 & Numerical Analysis & 2  \\
      \hline
      
 ART101 & Drawing & 2  \\
      \hline
\end{tabular}
\end{center}
\label{tab:2nf2}
\end{table}%
% ------------------------- % 
% 
% 
% 
% 
% 
 
 
 
 
 
 

 % ------ Table with San Serif Font ------ %              
\AtBeginEnvironment{tabular}{\sffamily}
\begin{table}[h!]
\caption{Table  in \texttt{2NF}.  What is the key?
   }
\begin{center}

Classes = \begin{tabular}{|c|c|c|}
   \hline
  \cellcolor{excel}{Class}  & \cellcolor{excel}{Description}
  \\
  \hline
  MAT190 & Calculus 1   \\
      \hline
 
 
 ENV104 & EnvSci.   \\
      \hline
      
    
 


BIO110 & Biology\\
      \hline
      
 MAT480 & Math Research  \\
      \hline
      
 MAT405 & Numerical Analysis   \\
      \hline
      
 ART101 & Drawing   \\
      \hline
\end{tabular}
\end{center}
\label{tab:2nf2}
\end{table}%
% ------------------------- % 
% 
% 
% 
 

% --------------------------------------------------
\hspace{-0.5cm}\rule[-0.101in]{\textwidth}{0.0025in}
% --------------------------------------------------
  
 





























 
 
 % ------- 3NF ---------- %
 \subsection*{Third Normal Form}
 Remove transitive dependencies (non-key columns depend ONLY\ on key).
  


 % ------ Table with San Serif Font ------ %              
\AtBeginEnvironment{tabular}{\sffamily}
\begin{table}[h!]
\caption{Table  in \texttt{3NF}.  What is the key?
   }
\begin{center}

Student\_Classes = \begin{tabular}{|c|c|}
   \hline
  \cellcolor{excel}{Class}  & \cellcolor{excel}{StudentID}
  \\
   \hline
  MAT190  & 1  \\
      \hline
 MAT190  & 3  \\
      \hline
 
 ENV104 & 1  \\
      \hline
      
      
 ENV104 & 3  \\
      \hline
 


BIO110 & 1  \\
      \hline
      
 MAT480 & 2  \\
      \hline
      
 MAT405  & 2  \\
      \hline
      
 ART101 & 2  \\
      \hline
\end{tabular}
\end{center}
\label{tab:3nf}
\end{table}%
% ------------------------- % 
% 
% 
% 
   


 % ------ Table with San Serif Font ------ %              
\AtBeginEnvironment{tabular}{\sffamily}
\begin{table}[h!]
\caption{ Normalize
   }
\begin{center}

\begin{tabular}{|c|c|c|c|c|c|c|c|c|}
   \hline
   \cellcolor{excel}{\textbf{TID}} & \cellcolor{excel}{\textbf{Tname}} & \cellcolor{excel}{\textbf{Dept}} & \cellcolor{excel}{\textbf{Building}} & \cellcolor{excel}{\textbf{Baddr}} & \cellcolor{excel}{\textbf{Office}} & \cellcolor{excel}{\textbf{SID}} & \cellcolor{excel}{\textbf{Sname}} & \cellcolor{excel}{\textbf{Course}} \\
   \hline
  
 1 & Adams  & MAT & A & 12 Broadway & 200 & 1 & Jones & MAT190\\
  
      \hline
      
 1 & Adams  & MAT & A & 12 Broadway & 200 & 2 & Rogers & MAT190\\
  
      \hline
     
 1 & Adams  & MAT & A & 12 Broadway & 200 & 3 & Blake & MAT195\\
  
      \hline
 2 & Bashforth  & MAT & A & 12 Broadway & 201 & 3 & Blake & MAT200 \\
  
      \hline      
 2 & Bashforth  & MAT & A & 12 Broadway & 201 & 4 & King & MAT200 \\
  \hline 
 2 & Bashforth  & MAT & A & 12 Broadway & 201 & 5 & Snow & MAT201 \\
   \hline 
      
 $\vdots$ & $\vdots$  & $\vdots$ & $\vdots$ & $\vdots$ &$\vdots$ & $\vdots$
& $\vdots$ & $\vdots$\\
  
   \hline 
 3 & Carrie  & HIS & B & 11 Hill & 111 & 5 & Snow & HIS101 \\
  
    
      \hline      
 3 & Carrie  & HIS & B & 11 HILL & 111 & 4 & King & HIS101 \\
  \hline 
 3 & Carrie  & HIS & B & 11 Hill & 111 & 5 & Fisher & HIS102 \\   
   \hline 
 3 & Carrie  & HIS & B & 11 Hill & 111 & 5 & Ramsey & HIS102 \\   
 
  \hline 
      
 4 & Adams  & HIS & B & 11 Hill & 200 & 6 & Flowers & HIS101\\
 
  \hline 
      
 $\vdots$ & $\vdots$  & $\vdots$ & $\vdots$ & $\vdots$ &$\vdots$ & $\vdots$ & $\vdots$ & $\vdots$\\
  
  
      \hline
      
      \hline         
\end{tabular}
\end{center}
\label{tab:3nf}
\end{table}%
% ------------------------- % 
% 
% 
% 
 
%\begin{outline}[enumerate]
%\1 \texttt{TID $\to$ Tname, Dept, Building, Baddr, Office}
%\1 
%\end{outline}    
  
%\begin{example}
        
%\end{example} 
  
  \begin{figure}[h!] %  figure placement: here, top, bottom, or page
     \centering
     \includegraphics[scale=0.80]{Class-model} 
     \caption{Teachers - Students - Classes}
     \label{fig:university}
  \end{figure}
  
  
% 
  
  
  
  
%+Bibliography
%\begin{thebibliography}{99}
%\bibitem{Label1} ...
%\bibitem{Label2} ...
%\end{thebibliography}
%-Bibliography



 

\end{document}
